# 인덱스 설계: 모수 축소 전략

맞습니다. 인덱스 설계의 핵심 원칙 중 하나는 **가능한 빨리 검색 대상 모수(데이터 집합)를 줄이는 것**입니다.

## 모수 축소 전략의 핵심

### 기본 원칙
인덱스의 선행 컬럼은 가능한 한 빨리 검색 대상을 줄일 수 있는 컬럼이 되어야 합니다. 이는 다음과 같은 이점을 제공합니다:

1. **디스크 I/O 감소**: 더 적은 데이터 블록을 읽음
2. **메모리 사용 효율화**: 더 적은 데이터를 메모리에 로드
3. **CPU 처리 부하 감소**: 더 적은 레코드를 처리

### 모수 축소 효과 비교

낮은 카디널리티 컬럼들 간의 비교에서도 이 원칙이 적용됩니다:

```
전체 데이터: 1,000,000 레코드
- 성별 필터링 (2개 값): 약 500,000 레코드로 축소 (50%)
- 연령대 필터링 (7개 값): 약 143,000 레코드로 축소 (14.3%)
```

연령대가 성별보다 모수를 더 많이 줄이므로, 연령대를 먼저 두는 것이 일반적으로 더 효과적입니다.

## 모수 축소 효과를 높이는 전략

### 1. 데이터 분포 고려
단순히 고유 값의 수뿐만 아니라 실제 분포도 중요합니다:

```
연령대 분포가 불균등한 경우:
- 20대: 70%
- 30대: 20%
- 기타: 10%

이 경우 '20대'로 검색하면 모수가 70%만 줄어듦
```

### 2. 선택도(Selectivity) 계산
각 컬럼의 선택도를 계산하여 비교:

```
선택도 = 고유 값 수 / 전체 레코드 수

성별 선택도: 2/1,000,000 = 0.000002
연령대 선택도: 7/1,000,000 = 0.000007
```

선택도가 높을수록 모수 축소 효과가 큽니다.

### 3. 실제 쿼리 패턴과 결합

WHERE 절에서 자주 단독으로 사용되는 컬럼을 앞에 배치:

```sql
-- 이런 쿼리가 빈번하다면
SELECT * FROM 테이블 WHERE 연령대 = '20대';

-- 연령대를 앞에 배치
CREATE INDEX idx_age_gender ON 테이블(연령대, 성별);
```

## 실무 적용 사례

### 1. 이커머스 사이트 상품 검색
```sql
-- 카테고리 > 브랜드 > 가격 순으로 모수 축소
CREATE INDEX idx_product_search ON products(category_id, brand_id, price);
```

### 2. 소셜 미디어 피드
```sql
-- 사용자 팔로워 관계에서 팔로워 수가 팔로잉 수보다 일반적으로 적으므로
CREATE INDEX idx_follows ON follows(follower_id, following_id);
```

### 3. 로그 분석
```sql
-- 시간 범위로 먼저 필터링 후 이벤트 타입으로 필터링
CREATE INDEX idx_logs ON logs(timestamp, event_type);
```

## 결론

인덱스 설계에서 가장 중요한 원칙 중 하나는 "가능한 빨리 검색 대상 모수를 줄이는 것"입니다. 이는 다음을 고려하여 결정됩니다:

1. 컬럼의 카디널리티(고유 값 수)
2. 데이터의 실제 분포
3. 쿼리 패턴과 필터링 조건의 사용 빈도
4. 각 컬럼의 선택도(selectivity)

---

### 기억해두면 좋은 영어 표현
- "Cardinality reduction" - 카디널리티 축소
- "Search space reduction" - 검색 공간 축소
- "Index selectivity" - 인덱스 선택도
- "Data filtering efficiency" - 데이터 필터링 효율성

### 영어로 질문하기
영어로 이 질문을 하신다면:
"Is it generally better to prioritize columns that reduce the dataset size more quickly when designing indexes?"

### 이직에 도움되는 정보
데이터베이스 성능 최적화 면접에서는 단순히 인덱스 문법을 아는 것보다 인덱스의 작동 원리와 설계 철학을 이해하고 있음을 보여주는 것이 중요합니다. 
"모수 축소 전략"을 설명할 때 실제 프로젝트에서 이를 적용해 얻은 성능 개선 사례(예: "인덱스 재설계로 쿼리 실행 시간을 60% 단축했다")를 
구체적인 수치와 함께 언급하면 실무 경험을 효과적으로 어필할 수 있습니다.